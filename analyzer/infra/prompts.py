from langchain_core.prompts import PromptTemplate

prompt_infra_analysis = PromptTemplate(
    input_variables=[],
    template="""
    아래 내용을 JSON 형식에 맞게 전달해줘
    
    data1 = "
    us-east-1 리전의 AWS 환경에 대한 보안 진단 결과를 보고드립니다.
    
    ## 📊 **전체 리소스 현황**
    - **IAM**: 사용자 2개, 역할 45개, 정책 34개
    - **VPC**: VPC 1개, 보안 그룹 1개, 네트워크 ACL 1개
    - **PrivateLink/Transit Gateway**: 리소스 없음
    
    ## 🚨 **발견된 주요 보안 취약점**
    
    ### 1. IAM 보안 관련 (위험도: 높음)
    #### 👤 **사용자 계정 관리**
    - **MFA 미활성화**: 모든 사용자(Administrator, Test)가 MFA를 설정하지 않음
    - **관리자 권한 남용**: 
      - `Administrator` 사용자: AdministratorAccess 정책 연결
      - `Test` 사용자: 4개의 Full Access 정책 연결
      - `Bedrock_Test_Role` 역할: AdministratorAccess 정책 연결
    
    #### 🔑 **액세스 키 관리**
    - **장기 사용 키**: Administrator의 액세스 키가 약 1.5개월간 회전 없이 사용
    - **최근 활동**: 모든 액세스 키가 최근에 사용됨 (잠재적 활성 상태)
    
    #### 📝 **인라인 정책 이슈**
    - `Test` 사용자에 2개의 인라인 정책 존재:
      - 와일드카드(*) 리소스 접근 권한
      - CloudTrail 전체 권한
    
    ### 2. VPC 네트워크 보안 (위험도: 중간)
    #### 🌐 **기본 VPC 사용**
    - 기본 VPC(172.31.0.0/16) 사용으로 보안 격리 부족
    - 인터넷 게이트웨이 직접 연결 (0.0.0.0/0 → igw)
    
    #### 🔒 **네트워크 접근 제어**
    - **기본 보안 그룹**: 모든 규칙이 비어있어 트래픽 차단 상태
    - **네트워크 ACL**: 기본 설정으로 모든 트래픽 허용 (위험)
      - 인바운드/아웃바운드 모두 0.0.0.0/0 허용
    
    #### 📊 **모니터링 부재**
    - **VPC Flow Log** 미설정
    - **트래픽 미러링** 미구성
    
    ### 3. 계정 보안 정책
    - **패스워드 정책** 미설정
    - **루트 계정** MFA 미활성화 (크리덴셜 리포트 확인)
    "
    
    data2 = "
    ## 💡 **권장 보안 조치사항**

    ### 즉시 조치 필요 (우선순위 1)
    1. **MFA 활성화**: 모든 사용자 및 루트 계정
    2. **권한 최소화**: 불필요한 Administrator 권한 제거
    3. **액세스 키 로테이션**: 정기적 키 교체 정책 수립
    
    ### 단기 조치 (1-2주내)
    1. **VPC Flow Log 활성화**: 네트워크 트래픽 모니터링
    2. **전용 VPC 구성**: 기본 VPC 대신 보안이 강화된 VPC 설계
    3. **네트워크 ACL 세분화**: 최소 권한 원칙 적용
    
    ### 중장기 조치 (1개월내)
    1. **보안 그룹 규칙 최적화**: 필요한 포트만 개방
    2. **IAM 정책 정비**: 인라인 정책을 관리형 정책으로 전환
    3. **계정 보안 정책 수립**: 패스워드 복잡도, 로그인 정책 등
    
    ### 지속적 모니터링
    1. **AWS CloudTrail 활성화**: API 호출 로깅
    2. **AWS Config 설정**: 리소스 변경 추적
    3. **정기 보안 점검**: 월 1회 권한 검토
    
    현재 환경은 개발/테스트 단계로 보이지만, 프로덕션 환경으로 전환 시 위 권장사항들을 우선적으로 적용하시길 권장드립니다.
    "
    
    ## 출력 형식 (JSON Only)
    {{
        "Result Report": {{
            "data": "data1"
        }},
        "Action Report": {{
            "data": "data2"
        }}
    }}
    
    출력 규칙
    - 반드시 위 구조를 그대로 따를 것
    - 문자열은 모두 큰따옴표로 감싼다.
    - JSON 이외의 텍스트(설명, 주석, 추가 구문)를 절대 포함하지 않는다.
    """
)